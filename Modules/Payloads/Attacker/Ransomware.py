
import os;
from cryptography.fernet import Fernet



def GenerateKey():
    key = Fernet.generate_key()

    with open("secrets.key", "ab") as keys:
        keys.write(key)




def DecryptFile(encryptFilename):

    try: 
        secretKey = open("secrets.key", "rb").read();
        fernet = Fernet(secretKey)


        with open(encryptFilename, "rb") as file:
            data = file.read(); 


        EncryptedData = fernet.decrypt(data);


        with open(encryptFilename.replace(".crypt", ""), "wb") as file:
            file.write(EncryptedData);
        

        os.remove(encryptFilename);
        return True

    except Exception as e:
        print(f"Error! {e}");
        return False; 


    





def DecryptRoute(route):

    for path, dirs, files in os.walk(route):
        for file in files:
            
            DecryptFile(os.path.join(path, file));

