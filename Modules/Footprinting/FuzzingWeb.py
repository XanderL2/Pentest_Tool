import requests as req
from colorama import init, Fore

init()








def FuzzingDomain(domain, dictionaryPath, methods = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH']):


    with open(dictionaryPath, 'r', encoding='utf-8') as dictionary:
        words = dictionary.read().split('\n')



    for i in range(len(words)):

        for method in methods:

            url = f'{domain}/{words[i]}'

            print(Fore.GREEN + f'URL: {url}' + Fore.RESET)


            resp = req.request(method, url)
            
            if resp.status_code >= 200 and resp.status_code < 300:
                print(Fore.GREEN + f'Endpoint Exists!  Status Code {resp.status_code} - OK - {method} - {url}' + Fore.RESET)


            elif resp.status_code in [301, 302, 307]:
                print(Fore.MAGENTA + f'Endpoint Exists!  Status Code {resp.status_code} - OK - {method} - {url}' + Fore.RESET)

                

            elif resp.status_code in [400, 401]:
                print(Fore.YELLOW + f'Endpoint Exists!  Status Code {resp.status_code} - OK - {method} - {url}' + Fore.RESET)























