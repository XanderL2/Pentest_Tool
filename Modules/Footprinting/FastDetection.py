import re, subprocess; 



                        # /24
def FastDetection(ip, netmask):


    hosts = [];



    #Ejecutamos el comando extrayendo su salida estandar
    results = subprocess.run(["sudo","arp-scan", "--interface=wlan0", "wlan0", f"{ip}{netmask}"], capture_output=True, text=True).stdout;
    


    #Mediante una expresion regular obtenemos informacion como la IP, Mac y Marca del dispositivo \s+ indica que habran uno o mas caracteres de espacio en blanco
    extractInfo= re.findall(r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d+)\s+([0-9a-fA-F:]+)\s+([^\n]+)", results );




    for i in range(len(extractInfo)):

        deviceInfo = {}; 

        for j in range(len(extractInfo[i])):
            deviceInfo.update({"IP": extractInfo[i][0], "Mac Address": extractInfo[i][1], "Marca": extractInfo[i][2]});
    

        hosts.append(deviceInfo);
    


    return hosts  #Retornamos la info de los hosts


