from scapy.all import sniff;


def packet_handler(packet):
    
    #Filtramos solo los paquetes pertenecientes al protocolo TCP y que tengan un Payload dentro
    if packet.haslayer("TCP") and packet.haslayer("Raw"):
        print(f"Source IP: {packet['IP'].src}")
        print(f"Destination IP: {packet['IP'].dst}")
        print(f"Source Port: {packet['TCP'].sport}")
        print(f"Destination Port: {packet['TCP'].dport}")
        print(f"Payload: {packet['Raw'].load.decode('utf-8', 'ignore')} \n")        
        
        

# Iniciamos el sniffer
sniff(iface = "wlan0" , prn=packet_handler, store=0)